<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- Saved on Sunday, November 22, 2020, 12:40 AM -->
<!-- MuClient version 5.07-pre -->

<!-- Plugin "Tallimos_MobKeyWordBF" generated by Plugin Wizard -->

<muclient>
<plugin
   name="Tallimos_MobKeyWordBF"
   author="Tallimos"
   id="a37d6804ac7168adfd1415d4"
   language="Lua"
   purpose="Will brute force the keyword of a mob via look"
   save_state="y"
   date_written="2020-11-22 00:39:31"
   requires="4.30"
   version="1.1"
   >

</plugin>


<!--  Get our standard constants -->

<include name="constants.lua"/>

<!--  Triggers  -->

<triggers>
	<trigger
		script="PerfectHealth"
		group="BruteForceTrigs"
		match="^(.*?) is in perfect health\."
		name="PerfectHealth"
		regexp="y"
		sequence="100"
		>
	</trigger>
	<trigger
		script="YouDontSee"
		group="BruteForceTrigs"
		match="^You don't see that here\."
		name="YouDontSee"
		regexp="y"
		sequence="100"
		omit_from_output="y"
		>
	</trigger>
</triggers>

<!--  Timers  -->

<timers>
	<timer name="BruteForceTimer" 
		second="1"  
		enabled="n"
		script="BruteForce"
		>
	</timer>
	<timer name="BruteForceTimer2" 
		second="2"  
		enabled="n"
		script="BruteForce"
		>
	</timer>
</timers>

<!--  Aliases  -->

<aliases>
	<alias
		match="^tbf (.*?)$"
		enabled="y"
		group="BruteForce"
		script="BruteForceStart"
		regexp="y"
		sequence="100"
		ignore_case="y"
		>
	</alias>
	<alias
		match="^tbf Help$"
		enabled="y"
		group="BruteForce"
		script="tbf_help"
		regexp="y"
		sequence="90"
		ignore_case="y"
		>
	</alias>
	<alias
		match="^tbf Abort$"
		enabled="y"
		group="BruteForce"
		script="BruteForceAbort"
		regexp="y"
		sequence="90"
		ignore_case="y"
		>
	</alias>
	<alias
		match="^tbf start (\w) (.*?)$"
		enabled="y"
		group="BruteForce"
		script="BruteForceStartAt"
		regexp="y"
		sequence="80"
		ignore_case="y"
		>
	</alias>
	<alias
		match="^tbf begin (\w+) (.*?)$"
		enabled="y"
		group="BruteForce"
		script="BruteForceStartBegin"
		regexp="y"
		sequence="90"
		ignore_case="y"
		>
	</alias>	
</aliases>


<!--  Script  -->

<script>
<![CDATA[

-- (.*?) (in from the|leaves|flies|arrives|pads|pads in from the) (north|east|south|west|up|down).

require "aard_register_z_on_create"

require "tprint"
require "mw_theme_base"
require "serialize"
require "commas"
require "gmcphelper"
require "copytable"
require "aardmapper"
require "aard_lua_extras"
require "wait"

local msg_colour      = "darkslategrey"
local err_colour      = "firebrick"
local help_colour     = "royalblue"
local qty_colour      = "yellow"
local optional_colour = "lightcoral"
local command_colour  = "white"
local cmd_required    = "royalblue"
local help_command_colour  = "red"

local line = "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-="

scanname = ""
lettertrack = 0
mobkeyword = ""
currentletter = ""
startletter = ""
mobnum = 1

function BruteForceAbort()
	check (ResetTimer ("BruteForceTimer"))
	check (ResetTimer ("BruteForceTimer2"))
	check (EnableTimer ("BruteForceTimer2", 0))
	check (EnableTimer ("BruteForceTimer", 0))
	world.EnableGroup ("BruteForceTrigs", 1)
	
	ColourNote(msg_colour, "", "Brute Force Aborted. Keyword before abort: ", help_command_colour, "", mobkeyword)
	
end

function BruteForceStartAt(name, line, wc)
	
	startletter = string.lower(wc[1])
	scanname = wc[2]
	mobnum = 1
	mobkeyword = ""
	
	for i,v in ipairs(AlphaTable) do
	
		alpha = string.lower(AlphaTable[i])
		if alpha == startletter then

			lettertrack = tonumber(i) - 1
			world.EnableGroup ("BruteForceTrigs", 1)
			check (EnableTimer ("BruteForceTimer", 1))
			check (ResetTimer ("BruteForceTimer"))
			
		end
		
	end
	
end

function BruteForceStartBegin(name, line, wc)

	mobkeyword = string.lower(wc[1])
	
	scanname = wc[2]
	lettertrack = 0
	mobnum = 1
	
	world.EnableGroup ("BruteForceTrigs", 1)
	check (EnableTimer ("BruteForceTimer", 1))
	check (ResetTimer ("BruteForceTimer"))

end

function BruteForceStart(name, line, wc)

	scanname = wc[1]
	lettertrack = 0
	mobnum = 1
	mobkeyword = ""
	
	world.EnableGroup ("BruteForceTrigs", 1)
	check (EnableTimer ("BruteForceTimer", 1))
	check (ResetTimer ("BruteForceTimer"))
	
end

function BruteForce()

	check (EnableTimer ("BruteForceTimer", 0))
	check (EnableTimer ("BruteForceTimer2", 1))
	check (ResetTimer ("BruteForceTimer2"))
	
	lettertrack = lettertrack + 1
	
	if lettertrack > 36 then
		ColourNote(msg_colour, "", "The mob's keyword is ", help_command_colour, "", mobkeyword)
		check (EnableTimer ("BruteForceTimer", 0))
		check (EnableTimer ("BruteForceTimer2", 0))
		world.EnableGroup ("BruteForceTrigs", 0)
	else
		currentletter = AlphaTable[lettertrack]
		Send ("look " .. mobkeyword .. currentletter)
	end
end
	
function PerfectHealth(name, line, wc)

	check (EnableTimer ("BruteForceTimer2", 0))
	
	local mobname = string.lower(wc[1])
	if mobname == string.lower(scanname) then
		mobkeyword = mobkeyword .. currentletter
		lettertrack = 0
		mobnum = 1
		check (EnableTimer ("BruteForceTimer", 1))
		check (ResetTimer ("BruteForceTimer"))
	else
		mobnum = mobnum + 1
		Send ("look " .. mobnum .. "." .. mobkeyword .. currentletter)
		check (EnableTimer ("BruteForceTimer2", 1))
		check (ResetTimer ("BruteForceTimer2"))

	end
end

function YouDontSee()

	check (EnableTimer ("BruteForceTimer2", 0))
	check (EnableTimer ("BruteForceTimer", 1))
	check (ResetTimer ("BruteForceTimer"))

end

function CreateBruteForceRefernce()

	AlphaTable = {}
	AlphaTable[1] = "a"
	AlphaTable[2] = "b"
	AlphaTable[3] = "c"
	AlphaTable[4] = "d"
	AlphaTable[5] = "e"
	AlphaTable[6] = "f"
	AlphaTable[7] = "g"
	AlphaTable[8] = "h"
	AlphaTable[9] = "i"
	AlphaTable[10] = "j"
	AlphaTable[11] = "k"
	AlphaTable[12] = "l"
	AlphaTable[13] = "m"
	AlphaTable[14] = "n"
	AlphaTable[15] = "o"
	AlphaTable[16] = "p"
	AlphaTable[17] = "q"
	AlphaTable[18] = "r"
	AlphaTable[19] = "s"
	AlphaTable[20] = "t"
	AlphaTable[21] = "u"
	AlphaTable[22] = "v"
	AlphaTable[23] = "w"
	AlphaTable[24] = "x"
	AlphaTable[25] = "y"
	AlphaTable[26] = "z"
	AlphaTable[27] = "0"
	AlphaTable[28] = "1"
	AlphaTable[29] = "2"
	AlphaTable[30] = "3"
	AlphaTable[31] = "4"
	AlphaTable[32] = "5"
	AlphaTable[33] = "6"
	AlphaTable[34] = "7"
	AlphaTable[35] = "8"
	AlphaTable[36] = "9"

end

function tbf_help()
	
	local title = "Tallimos' Mob Keyword Brute Force Extractor Help"
	local title2 = "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-="
		
	local leng = tonumber(string.len(title))
	local leng2 = tonumber(string.len(title2))
	
	local spacing = 0
	local lendif = 0
	
	if leng > leng2 then
	else
		lendif = leng2 - leng
		lendif = lendif * 0.5
	end

	spacing = string.rep(" ", lendif)
	
	ColourNote(help_colour, "", spacing, help_command_colour, "", "Tallimos' Mob Keyword Brute Force Extractor Help")
	ColourNote(help_colour, "", "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=")
	ColourNote(help_colour, "", "This plugin gives the user an automated way of figuring out not so obvious")
	ColourNote(help_colour, "", "keywords for mobs.")
	ColourNote(help_colour, "", "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=")
	Note("")

	ColourNote(help_command_colour, "", "tbf <mobname>", help_colour, "", " - command to start the brute force process")
	Note("")
	
	ColourNote(help_command_colour, "", "tbf start <letter> <mobname>")
	ColourNote(help_colour, "", "              - command to start the brute force process at a particular letter")
	Note("")
	
	ColourNote(help_command_colour, "", "tbf begin <partial keyword> <mobname>")
	ColourNote(help_colour, "", "              - command to begin the brute force process with a partial keyword")
	ColourNote(help_colour, "", "                already discovered")
	Note("")
	
	ColourNote(help_command_colour, "", "tbf abort", help_colour, "", "     - command to abort the brute force process")
	Note("")
	
	ColourNote(help_command_colour, "", "Please Note:", qty_colour, "", " <mobname>", help_colour, "", " is the name of mob that appears on scan")
	Note("")
	
	ColourNote(help_colour, "", "=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=")
	Note("")

end	-- tbf_help

function OnPluginInstall ()

	ColourNote(help_colour, "", "Thank you for installing Tallimos' Mob Keyword Brute Force Extractor. Please see ", help_command_colour, "", "tbf help", help_colour, "", " for more information.")
	
	CreateBruteForceRefernce()

end

function OnPluginEnable()
	CreateBruteForceRefernce()
end


]]>
</script>
</muclient>
